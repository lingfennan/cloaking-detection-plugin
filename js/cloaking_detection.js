{"package":"cloaking_detection","messages":[{"name":"LearnedSites","fields":[{"rule":"repeated","options":{},"type":"SitePatterns","name":"site","id":1},{"rule":"optional","options":{},"type":"string","name":"timestamp","id":2}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"SitePatterns","fields":[{"rule":"required","options":{},"type":"string","name":"name","id":1},{"rule":"repeated","options":{},"type":"Pattern","name":"pattern","id":2}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"Pattern","fields":[{"rule":"optional","options":{},"type":"double","name":"mean","id":1},{"rule":"optional","options":{},"type":"double","name":"std","id":2},{"rule":"repeated","options":{},"type":"SimhashItem","name":"item","id":3},{"rule":"repeated","options":{"packed":true},"type":"uint64","name":"centroid","id":4},{"rule":"optional","options":{},"type":"uint64","name":"size","id":5},{"rule":"optional","options":{},"type":"double","name":"mce_threshold","id":6},{"rule":"optional","options":{},"type":"CDF","name":"cdf","id":7},{"rule":"optional","options":{},"type":"Percentile","name":"percentile","id":8},{"rule":"repeated","options":{"packed":true},"type":"double","name":"link_heights","id":9}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"Percentile","fields":[{"rule":"optional","options":{},"type":"uint32","name":"p99","id":1},{"rule":"optional","options":{},"type":"uint32","name":"p97","id":2},{"rule":"optional","options":{},"type":"uint32","name":"p95","id":3},{"rule":"optional","options":{},"type":"uint32","name":"p90","id":4},{"rule":"optional","options":{},"type":"uint32","name":"p75","id":5},{"rule":"optional","options":{},"type":"uint32","name":"p50","id":6}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"CDF","fields":[{"rule":"repeated","options":{},"type":"Point","name":"point","id":1}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"Point","fields":[{"rule":"required","options":{},"type":"uint32","name":"x","id":1},{"rule":"required","options":{},"type":"uint64","name":"count","id":2}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"SimhashItem","fields":[{"rule":"required","options":{},"type":"uint64","name":"simhash","id":1},{"rule":"optional","options":{"default":1},"type":"uint64","name":"count","id":2},{"rule":"optional","options":{},"type":"string","name":"sample_file_path","id":3}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"ObservedSites","fields":[{"rule":"repeated","options":{},"type":"SiteObservations","name":"site","id":1},{"rule":"optional","options":{},"type":"SimhashConfig","name":"config","id":2}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"SiteObservations","fields":[{"rule":"required","options":{},"type":"string","name":"name","id":1},{"rule":"repeated","options":{},"type":"Observation","name":"observation","id":2}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"Observation","fields":[{"rule":"required","options":{},"type":"string","name":"landing_url","id":1},{"rule":"optional","options":{},"type":"string","name":"file_path","id":2},{"rule":"optional","options":{},"type":"string","name":"timestamp","id":3},{"rule":"optional","options":{},"type":"uint64","name":"text_simhash","id":4},{"rule":"optional","options":{},"type":"uint64","name":"dom_simhash","id":5},{"rule":"optional","options":{},"type":"uint32","name":"text_feature_count","id":6},{"rule":"optional","options":{},"type":"uint32","name":"dom_feature_count","id":7}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"DeNoiseConfig","fields":[{"rule":"optional","options":{"default":true},"type":"bool","name":"empty_file_path","id":1},{"rule":"optional","options":{"default":true},"type":"bool","name":"zero_simhash","id":2},{"rule":"optional","options":{"default":false},"type":"bool","name":"zero_feature","id":3},{"rule":"optional","options":{},"type":"string","name":"simhash_name","id":4},{"rule":"optional","options":{},"type":"string","name":"feature_name","id":5},{"rule":"optional","options":{"default":1},"type":"uint32","name":"feature_count_threshold","id":6}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"HtmlText","fields":[{"rule":"repeated","options":{},"type":"Feature","name":"word","id":1},{"rule":"repeated","options":{},"type":"Feature","name":"bi_gram","id":2},{"rule":"repeated","options":{},"type":"Feature","name":"tri_gram","id":3}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"HtmlDom","fields":[{"rule":"repeated","options":{},"type":"Feature","name":"node","id":1},{"rule":"repeated","options":{},"type":"Feature","name":"bi_node","id":2},{"rule":"repeated","options":{},"type":"Feature","name":"tri_node","id":3}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"Feature","fields":[{"rule":"required","options":{},"type":"string","name":"name","id":1},{"rule":"optional","options":{"default":1},"type":"int32","name":"int_value","id":2},{"rule":"optional","options":{},"type":"double","name":"double_value","id":3},{"rule":"optional","options":{},"type":"string","name":"string_value","id":4}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"SimhashConfig","fields":[{"rule":"required","options":{},"type":"SimhashType","name":"simhash_type","id":1},{"rule":"optional","options":{},"type":"FeatureUsage","name":"usage","id":2},{"rule":"optional","options":{"default":10},"type":"int32","name":"maximum_threads","id":3},{"rule":"optional","options":{"default":true},"type":"bool","name":"discard_failure","id":4},{"rule":"optional","options":{"default":true},"type":"bool","name":"crawl_log_landing_url_as_observation_landing_url","id":5}],"enums":[],"messages":[{"name":"FeatureUsage","fields":[{"rule":"optional","options":{"default":true},"type":"bool","name":"gram","id":1},{"rule":"optional","options":{"default":true},"type":"bool","name":"bi_gram","id":2},{"rule":"optional","options":{"default":false},"type":"bool","name":"tri_gram","id":3}],"enums":[],"messages":[],"options":{},"oneofs":{}}],"options":{},"oneofs":{}},{"name":"Algorithm","fields":[{"rule":"required","options":{},"type":"AlgoName","name":"name","id":1},{"rule":"optional","options":{},"type":"int32","name":"thres","id":2},{"rule":"optional","options":{},"type":"int32","name":"k","id":3},{"rule":"optional","options":{"deprecated":true},"type":"int32","name":"left_out_ratio","id":4},{"rule":"optional","options":{"default":1},"type":"double","name":"inconsistent_coefficient","id":5},{"rule":"optional","options":{"deprecated":true},"type":"int32","name":"inconsistent_depth","id":6}],"enums":[{"name":"AlgoName","values":[{"name":"HAMMING_THRESHOLD","id":0},{"name":"K_MEANS","id":1},{"name":"SPECTRAL_CLUSTERING","id":2},{"name":"HIERARCHICAL_CLUSTERING","id":3}],"options":{}}],"messages":[],"options":{},"oneofs":{}},{"name":"ClusterConfig","fields":[{"rule":"required","options":{},"type":"Algorithm","name":"algorithm","id":1},{"rule":"optional","options":{"deprecated":true},"type":"int32","name":"minimum_cluster_size","id":2},{"rule":"optional","options":{"default":10},"type":"int32","name":"maximum_threads","id":3},{"rule":"optional","options":{"default":"TEXT"},"type":"SimhashType","name":"simhash_type","id":4},{"rule":"optional","options":{"deprecated":true},"type":"bool","name":"use_simhash_count","id":5}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"DetectionConfig","fields":[{"rule":"required","options":{},"type":"Algorithm","name":"algorithm","id":1},{"rule":"optional","options":{},"type":"int32","name":"std_constant","id":2},{"rule":"optional","options":{"default":"TEXT"},"type":"SimhashType","name":"simhash_type","id":3},{"rule":"optional","options":{"default":97},"type":"int32","name":"p","id":4},{"rule":"optional","options":{"default":0},"type":"double","name":"min_radius","id":5},{"rule":"optional","options":{"default":1},"type":"double","name":"inconsistent_coefficient","id":6}],"enums":[{"name":"Algorithm","values":[{"name":"NORMAL_DISTRIBUTION","id":0},{"name":"GRADIENT_DESCENT","id":1},{"name":"JOINT_DISTRIBUTION","id":2},{"name":"PERCENTILE","id":3},{"name":"INCONSISTENT_COEFFICIENT","id":4}],"options":{}}],"messages":[],"options":{},"oneofs":{}},{"name":"CrawlConfig","fields":[{"rule":"optional","options":{},"type":"int32","name":"maximum_threads","id":1},{"rule":"optional","options":{},"type":"string","name":"user_agent","id":2},{"rule":"optional","options":{},"type":"string","name":"user_agent_md5_dir","id":3},{"rule":"optional","options":{},"type":"BrowserType","name":"browser_type","id":4},{"rule":"optional","options":{"default":"AD"},"type":"ResultType","name":"result_type","id":5},{"rule":"optional","options":{"default":200},"type":"int32","name":"count","id":6},{"rule":"optional","options":{},"type":"string","name":"log_filename","id":7},{"rule":"optional","options":{},"type":"string","name":"crawl_log_dir","id":8}],"enums":[{"name":"BrowserType","values":[{"name":"CHROME","id":0},{"name":"FIREFOX","id":1},{"name":"HTMLUNIT","id":2}],"options":{}}],"messages":[],"options":{},"oneofs":{}},{"name":"CrawlLog","fields":[{"rule":"repeated","options":{},"type":"CrawlSearchTerm","name":"result_search","id":1}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"CrawlSearchTerm","fields":[{"rule":"optional","options":{},"type":"string","name":"search_term","id":1},{"rule":"optional","options":{"default":"AD"},"type":"ResultType","name":"result_type","id":2},{"rule":"repeated","options":{},"type":"CrawlResult","name":"result","id":3}],"enums":[],"messages":[],"options":{},"oneofs":{}},{"name":"CrawlResult","fields":[{"rule":"optional","options":{},"type":"string","name":"file_path","id":1},{"rule":"optional","options":{},"type":"string","name":"landing_url","id":2},{"rule":"optional","options":{},"type":"string","name":"landing_url_md5","id":3},{"rule":"optional","options":{},"type":"string","name":"url","id":4},{"rule":"optional","options":{},"type":"string","name":"url_md5","id":5},{"rule":"optional","options":{},"type":"string","name":"timestamp","id":6},{"rule":"optional","options":{},"type":"bool","name":"success","id":7}],"enums":[],"messages":[],"options":{},"oneofs":{}}],"enums":[{"name":"SimhashType","values":[{"name":"TEXT","id":0},{"name":"DOM","id":1},{"name":"TEXT_DOM","id":2}],"options":{}},{"name":"ResultType","values":[{"name":"AD","id":0},{"name":"SEARCH","id":1}],"options":{}},{"name":"ParaType","values":[{"name":"NORMAL","id":0},{"name":"FILE_PATH","id":1}],"options":{}}],"imports":[],"options":{},"services":[]}
